{% load static %}
{% load custom_filters %}
<!DOCTYPE html>
<html lang="fa">

<head>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="keywords" content="">

    <title>موپلی | {% block title %}{% endblock %}</title>

    <link rel="icon" type="image/x-icon" href="{% static 'images/favicon.png' %}">

    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/all-fontawesome.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/icomoon.css' %}">
    <link rel="stylesheet" href="{% static 'css/animate.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/magnific-popup.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/nice-select.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/plyr.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">

    <style>
        .alert-container {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 9999;
            max-width: 350px;
        }

        .alert {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            border-radius: 8px;
            margin-bottom: 10px;
            animation: slideInRight 0.5s forwards;
            transition: all 0.5s ease;
        }

        .alert.fade-out {
            animation: slideOutRight 0.5s forwards;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOutRight {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        .alert-dismissible .btn-close {
            padding: 0.75rem;
        }
    </style>

</head>

<body>

    <div class="preloader d-none" >
        <div class="loader-ripple">
            <div></div>
            <div></div>
        </div>
    </div>

    <header class="header" dir="rtl">
        <div class="main-navigation">
            <nav class="navbar navbar-expand-lg">
                <div class="container position-relative">
                    <a class="navbar-brand" href="{% url 'core:home' %}">
                        <img src="{% static 'images/logo.png' %}" class="logo-dark-mode" alt="logo">
                        <img src="{% static 'images/logo-dark.png' %}" class="logo-light-mode" alt="logo">
                    </a>
                    <div class="mobile-menu-right">
                        <div class="nav-search-wrap">
                            <div class="search-btn">
                                <button type="button" class="nav-right-link search-box-outer"><i
                                        class="icon-search"></i></button>
                            </div>

                            <div class="search-area">
                                <form action="{% url 'search_results' %}">
                                    <div class="form-group">
                                        <input type="text" name="search" class="form-control" placeholder="عنوان فیلم یا سریال" value="{{ query }}">
                                        <button type="submit" class="search-icon-btn"><i class="icon-search"></i></button>
                                    </div>
                                </form>
                            </div>

                        </div>
                        <div class="color-mode theme-mode-control">
                            <button type="button" class="nav-right-link light-btn"><i class="icon-sun"></i></button>
                            <button type="button" class="nav-right-link dark-btn"><i class="icon-moon-2"></i></button>
                        </div>
                        <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                            data-bs-target="#main_nav" aria-expanded="false" aria-label="Toggle navigation">
                            <span class="navbar-toggler-mobile-icon"><i class="icon-menu-2"></i></span>
                        </button>
                    </div>
                    <div class="collapse navbar-collapse" id="main_nav">
                        <ul class="navbar-nav">
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="javascript:void(0)" data-bs-toggle="dropdown">ژانر فیلم</a>
                                <div class="dropdown-menu mega-menu fade-down">
                                    <div class="row">
                                        {% for column in genres_movies|split_into_columns:3 %}
                                        <div class="col-lg-4">
                                            {% for genre in column %}
                                                <a class="dropdown-item" href="{% url 'movie:genre_movies' genre.slug %}">{{ genre.title }}</a>
                                            {% endfor %}
                                        </div>
                                        {% endfor %}
                                    </div>
                                </div>
                            </li>
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="javascript:void(0)" data-bs-toggle="dropdown">ژانر سریال</a>
                                <div class="dropdown-menu mega-menu fade-down">
                                    <div class="row">
                                        {% for column in genres_series|split_into_columns:3 %}
                                        <div class="col-lg-4">
                                            {% for genre in column %}
                                                <a class="dropdown-item" href="{% url 'movie:genre_series' genre.slug %}">{{ genre.title }}</a>
                                            {% endfor %}
                                        </div>
                                        {% endfor %}
                                    </div>
                                </div>
                            </li>
                            <li class="nav-item live"><a class="nav-link" href="{% url 'movie:actors' %}">بازیگران</a></li>
                            <li class="nav-item live"><a class="nav-link" href="{% url 'blog:article_list' %}">وبلاگ</a></li>
                            <li class="nav-item live"><a class="nav-link" href="{% url 'subscription:plans' %}">خرید اشتراک</a></li>
                        </ul>
                        <div class="nav-right">
                            <div class="nav-search-wrap">
                                <div class="search-btn">
                                    <button type="button" class="nav-right-link search-box-outer"><i
                                            class="icon-search"></i></button>
                                </div>

                                <div class="search-area">
                                    <form action="{% url 'search_results' %}">
                                        <div class="form-group">
                                            <input type="text" name="search" class="form-control" placeholder="عنوان فیلم یا سریال" value="{{ query }}">
                                            <button type="submit" class="search-icon-btn"><i class="icon-search"></i></button>
                                        </div>
                                    </form>
                                </div>

                            </div>
                            <div class="color-mode theme-mode-control">
                                <button type="button" class="nav-right-link light-btn"><i class="icon-sun"></i></button>
                                <button type="button" class="nav-right-link dark-btn"><i class="icon-moon-2"></i></button>
                            </div>
                            <div class="nav-right-btn">
                                {% if request.user.is_authenticated %}
                                    <a href="{% url 'dashboard:dashboard' %}" class="theme-btn"><i class="far fa-user"></i>پنل کاربری</a>
                                {% else %}
                                    <a href="{% url 'accounts:login' %}" class="theme-btn"><i class="far fa-sign-in"></i>ورود</a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <!-- show all messages -->
    {% if messages %}
        <div class="alert-container">
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            {% endfor %}
        </div>
    {% endif %}

    {% block content %}{% endblock %}

    <footer class="footer-area" dir="rtl">
        <div class="footer-widget">
            <div class="container">
                <div class="footer-widget-wrapper pt-100 pb-50">
                    <div class="row">
                        <div class="col-md-6 col-lg-3">
                            <div class="footer-widget-box about-us">
                                <a href="{% url 'core:home' %}" class="footer-logo">
                                    <img src="{% static 'images/logo.png' %}" class="logo-dark-mode" alt="logo">
                                    <img src="{% static 'images/logo-dark.png' %}" class="logo-light-mode" alt="logo">
                                </a>
                                <p class="mb-3">
                                    موپلی - پلتفرم استریم ویدیوی پیشرو در ایران
                                دسترسی به هزاران محتوای جذاب با کیفیت بالا
                                و تجربه کاربری بی‌نظیر برای شما
                                </p>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-2">
                            <div class="footer-widget-box list">
                                <h4 class="footer-widget-title">دسترسی سریع</h4>
                                <ul class="footer-list">
                                    <li><a href="{% url 'movie:movies' %}">فیلم ‌ها</a></li>
                                    <li><a href="{% url 'movie:series' %}">سریال‌ ها</a></li>
                                    <li><a href="{% url 'movie:actors' %}">بازیگران</a></li>
                                    <li><a href="{% url 'movie:directors' %}">کارگردانان</a></li>
                                    <li><a href="{% url 'movie:suggestions' %}">پیشنهادات</a></li>
                                    <li><a href="{% url 'blog:article_list' %}">وبلاگ</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-2">
                            <div class="footer-widget-box list">
                                <h4 class="footer-widget-title">اطلاعات بیشتر</h4>
                                <ul class="footer-list">
                                    <li><a href="{% url 'core:about' %}">درباره ما</a></li>
                                    <li><a href="{% url 'core:faq' %}">سوالات متداول</a></li>
                                    <li><a href="{% url 'core:terms' %}">قوانین و مقررات</a></li>
                                    <li><a href="{% url 'subscription:plans' %}">خرید اشتراک</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-2">
                            <div class="footer-widget-box list">
                                <h4 class="footer-widget-title">پشتیبانی</h4>
                                <ul class="footer-list">
                                    <li><a href="{% url 'core:faq' %}">راهنمای استفاده</a></li>
                                <li><a href="{% url 'core:contact' %}">تماس با پشتیبانی</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3">
                            <div class="footer-widget-box list">
                                <h4 class="footer-widget-title">خبرنامه</h4>
                                <div class="footer-newsletter">
                                    <p>برای دریافت آخرین به روز رسانی و اخبار، در خبرنامه ما مشترک شوید</p>
                                    <div class="subscribe-form">
                                        <form method="post" action="{% url 'core:newsletter' %}">
                                            {% csrf_token %}
                                            <input type="email" name="email" id="email" maxlength="100" class="form-control" required placeholder="ایمیل">
                                            <button class="theme-btn" type="submit">
                                                <span class="icon-paper-plane"></span>عضویت
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="footer-top-link">
                                {% for tag in popular_tags %}
                                    <a href="{% url 'movie:tag_detail' tag.slug %}">{{ tag.title }}</a>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="copyright" >
            <div class="container">
                <div class="row" >
                    <div class="col-md-6 align-self-center">
                        <p class="copyright-text">
                            © کلیه حقوق مادی و معنوی این وبسایت متعلق به <a href="{% url 'core:home' %}"> موپلی </a> میباشد.
                        </p>
                    </div>
                    <div class="col-md-6 align-self-center">
                        <ul class="footer-social">
                            <li><a href="https://t.me/moplay"><i class="fab fa-telegram"></i></a></li>
                            <li><a href="https://instagram.com/moplay"><i class="fab fa-instagram"></i></a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <a href="#" id="scroll-top"><i class="far fa-arrow-up-from-arc"></i></a>

    <script src="{% static 'js/jquery-3.6.0.min.js' %}"></script>
    <script src="{% static 'js/modernizr.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'js/imagesloaded.pkgd.min.js' %}"></script>
    <script src="{% static 'js/jquery.magnific-popup.min.js' %}"></script>
    <script src="{% static 'js/isotope.pkgd.min.js' %}"></script>
    <script src="{% static 'js/jquery.appear.min.js' %}"></script>
    <script src="{% static 'js/jquery.easing.min.js' %}"></script>
    <script src="{% static 'js/owl.carousel.min.js' %}"></script>
    <script src="{% static 'js/counter-up.js' %}"></script>
    <script src="{% static 'js/wow.min.js' %}"></script>
    <script src="{% static 'js/jquery.nice-select.min.js' %}"></script>
    <script src="{% static 'js/plyr.min.js' %}"></script>
    <script src="{% static 'js/main.js' %}"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(function() {
                var alerts = document.querySelectorAll('.alert');
                alerts.forEach(function(alert) {
                    alert.classList.add('fade-out');

                    setTimeout(function() {
                        if (alert.parentNode) {
                            alert.parentNode.removeChild(alert);
                        }
                    }, 500);
                });
            }, 5000);

            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('btn-close')) {
                    var alert = e.target.closest('.alert');
                    if (alert) {
                        alert.classList.add('fade-out');
                        setTimeout(function() {
                            if (alert.parentNode) {
                                alert.parentNode.removeChild(alert);
                            }
                        }, 500);
                    }
                }
            });
        });
    </script>

</body>
</html>